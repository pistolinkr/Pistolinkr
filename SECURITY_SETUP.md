# 🔐 보안 설정 가이드

## 🚨 보안 강화 완료

이제 관리자 비밀번호가 클라이언트 사이드에서 제거되고 서버 사이드 인증으로 변경되었습니다.

## 📋 설정 단계

### 1. 환경 변수 설정

#### 로컬 개발용 (.env.local)
프로젝트 루트에 `.env.local` 파일을 생성하고 다음 내용을 추가하세요:

```env
# 기존 Supabase 설정
NEXT_PUBLIC_SUPABASE_URL=https://kwdxnvxjpacrjmamuern.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_URL=https://kwdxnvxjpacrjmamuern.supabase.co

# 🔐 새로운 인증 비밀번호 (서버 사이드에서만 사용)
ADMIN_PASSWORD=Parky096@QZ
USER_PASSWORD=0127942
```

#### Vercel 배포용
Vercel 대시보드 → Settings → Environment Variables에서 다음 추가:

```
ADMIN_PASSWORD=Parky096@QZ
USER_PASSWORD=0127942
```

### 2. 보안 개선사항

#### ✅ 완료된 보안 강화:
- ❌ **제거됨**: 클라이언트 사이드 하드코딩된 비밀번호
- ✅ **추가됨**: 서버 사이드 인증 API (`/api/auth`)
- ✅ **추가됨**: 환경 변수를 통한 비밀번호 관리
- ✅ **추가됨**: JWT 토큰 기반 세션 관리
- ✅ **추가됨**: 로딩 상태 및 에러 처리 개선

#### 🔒 보안 특징:
1. **서버 사이드 검증**: 비밀번호는 서버에서만 검증
2. **환경 변수**: 민감한 정보는 환경 변수로 관리
3. **토큰 기반**: 세션 관리를 위한 JWT 토큰 사용
4. **에러 처리**: 보안 관련 에러 메시지 최소화
5. **역할 기반 접근**: 특정 사용자는 관리자 비밀번호만 사용 가능

### 3. API 엔드포인트

#### POST `/api/auth`
- **기능**: 사용자 인증
- **요청**: `{ name: string, password: string }`
- **응답**: `{ success: boolean, isAdmin: boolean, token: string }`

### 4. 배포 시 주의사항

#### Vercel 배포:
1. Vercel 대시보드에서 환경 변수 설정
2. `ADMIN_PASSWORD`와 `USER_PASSWORD` 추가
3. 프로젝트 재배포

#### 로컬 개발:
1. `.env.local` 파일 생성
2. 환경 변수 설정
3. 개발 서버 재시작

### 5. 보안 모범 사례

#### ✅ 권장사항:
- 정기적인 비밀번호 변경
- 강력한 비밀번호 사용
- HTTPS 사용
- 환경 변수 백업

#### ❌ 주의사항:
- 비밀번호를 코드에 하드코딩하지 않기
- 환경 변수를 Git에 커밋하지 않기
- 토큰을 클라이언트에 노출하지 않기

### 6. 사용자 권한 관리

#### 허용된 사용자:
- **성동영, 박상현**: 일반 비밀번호 또는 관리자 비밀번호 사용 가능
- **Aventa R. Sevena**: 관리자 비밀번호만 사용 가능 (일반 비밀번호로는 로그인 불가)

#### 권한 수준:
- **일반 사용자**: 대시보드 조회, 설정 변경
- **관리자**: 모든 기능 + 관리자 설정 접근

### 7. 문제 해결

#### 인증이 작동하지 않는 경우:
1. 환경 변수가 올바르게 설정되었는지 확인
2. API 엔드포인트가 접근 가능한지 확인
3. 브라우저 콘솔에서 에러 메시지 확인
4. 사용자 이름과 권한이 올바른지 확인

#### 서버 오류가 발생하는 경우:
1. Supabase 연결 상태 확인
2. 환경 변수 유효성 검사
3. API 로그 확인

## 🎯 보안 수준

### 이전 (취약):
- ❌ 비밀번호가 클라이언트 코드에 노출
- ❌ 개발자 도구에서 쉽게 확인 가능
- ❌ 누구나 소스 코드에서 비밀번호 확인 가능

### 현재 (보안 강화):
- ✅ 비밀번호는 서버에서만 검증
- ✅ 클라이언트 코드에서 비밀번호 제거
- ✅ 환경 변수를 통한 안전한 관리
- ✅ 토큰 기반 세션 관리

## 📞 지원

보안 관련 문의사항이 있으시면 언제든지 연락주세요. 